0) host discovery or ping scan
nmap –sP 192.168.1.0/24

1) Nmap Target Selection
nmap 192.168.1.1
nmap www.testhostname.com
nmap 192.168.1.1-20
nmap 192.168.1.0/24
nmap -iL list-of-ips.txt

2) Nmap Port Selection
nmap -p 22 192.168.1.1
nmap -p 1-100 192.168.1.1
nmap -F 192.168.1.1 (100 most common ports <Fast>)
nmap -p- 192.168.1.1 (all 65535 ports)

3) Nmap Port Scan types
nmap -sT 192.168.1.1
nmap -sS 192.168.1.1
nmap -sU -p 123,161,162 192.168.1.1 (UDP)
nmap -Pn -F 192.168.1.1 (igore discovery)

4) Service and OS Detection
nmap –O 192.168.1.1
nmap -A 192.168.1.1
nmap –v –A 192.168.1.1
nmap –A –iL /tmp/scanlist.txt
nmap -sV 192.168.1.1
nmap -sV --version-intensity 5 192.168.1.1 (aggresive service detection)
nmap -sV --version-intensity 0 192.168.1.1 (banner grabbing)

5) Nmap Output Formats
nmap -oN outputfile.txt 192.168.1.1 (default)
nmap -oX outputfile.xml 192.168.1.1
nmap -oG outputfile.txt 192.168.1.1 (grep)
nmap -oA outputfile 192.168.1.1

6) NSE Scripts
nmap -sV -sC 192.168.1.1 (default safe scripts)
nmap --script-help=ssl-heartbleed (get help for a script)
nmap -sV -p 443 –script=ssl-heartbleed.nse 192.168.1.1
nmap -sV --script=smb* 192.168.1.1 (set of scripts)
locate nse | grep script (get a list of installed scripts)

7) HTTP Service information
nmap --script=http-title 192.168.1.0/24 (gather page titles)
nmap --script=http-headers 192.168.1.0/24
nmap --script=http-enum 192.168.1.0/24 (find web apps from known paths)

8) if a host/network is protected by a firewall
nmap –sA 192.168.1.254
nmap –sA server1.cyberciti.biz

8.1) scan a host when protected by the firewall
nmap –PN 192.168.1.1
nmap –PN server1.cyberciti.biz

EXTRA:
* DDOS reflection UDP services
nmap –sU –A –PN –n –pU:19,53,123,161 –script=ntp-monlist,dns-recursion,snmp-sysdescr 192.168.1.0/24
* IP Add info
nmap --script=asn-query,whois,ip-geolocation-maxmind 192.168.1.0/24
